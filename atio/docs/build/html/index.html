

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Atio Documentation &mdash; atio  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Modules" href="api/modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            atio
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">Modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">atio</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Atio Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="atio-documentation">
<h1>Atio Documentation<a class="headerlink" href="#atio-documentation" title="Link to this heading"></a></h1>
</section>
<section id="atio">
<h1>Atio 🛡️<a class="headerlink" href="#atio" title="Link to this heading"></a></h1>
<p>안전하고 <strong>원자적인 파일 쓰기</strong>를 지원하는 경량 Python 라이브러리입니다.<br />
Pandas, Polars, NumPy 등 데이터 객체 저장 시 <strong>파일 손상 없이</strong>, <strong>트랜잭션처럼 안전하게 처리</strong>할 수 있습니다.</p>
<hr class="docutils" />
<section id="id1">
<h2>🌟 주요 기능<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>✅ 임시 디렉토리 스테이징 후 <strong>원자적 파일 교체</strong></p></li>
<li><p>📦 Pandas, Polars, NumPy 등 다양한 데이터 객체 지원</p></li>
<li><p>📍 <code class="docutils literal notranslate"><span class="pre">_SUCCESS</span></code> 플래그 파일 생성 — 저장 완료 여부 표시</p></li>
<li><p>🛠 실패 시 <strong>원본 파일 보존</strong>, 임시 파일 자동 정리</p></li>
<li><p>🧩 플러그인 아키텍처로 <strong>확장성 좋음</strong></p></li>
<li><p>🔍 <strong>성능 진단 로깅</strong> — 각 단계별 실행 시간 측정 및 병목점 분석</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="new">
<h2>🔍 성능 진단 로깅 (NEW!)<a class="headerlink" href="#new" title="Link to this heading"></a></h2>
<p>Atio는 이제 <strong>성능 진단 로깅</strong> 기능을 제공합니다. <code class="docutils literal notranslate"><span class="pre">verbose=True</span></code> 옵션을 사용하면 각 단계별 실행 시간을 측정하여 병목점을 정확히 파악할 수 있습니다.</p>
<section id="id2">
<h3>기본 사용법 (간단한 정보만):<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">atio</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">aw</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>

<span class="c1"># 기본 사용법 - 간단한 성공/실패 정보만</span>
<span class="n">aw</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;output.parquet&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;parquet&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>출력 예시:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">임시</span> <span class="n">디렉토리</span> <span class="n">생성</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmp_xxx</span>
<span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">임시</span> <span class="n">파일</span> <span class="n">경로</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmp_xxx</span><span class="o">/</span><span class="n">output</span><span class="o">.</span><span class="n">parquet</span>
<span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">사용할</span> <span class="n">writer</span><span class="p">:</span> <span class="n">to_parquet</span> <span class="p">(</span><span class="nb">format</span><span class="p">:</span> <span class="n">parquet</span><span class="p">)</span>
<span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">데이터</span> <span class="n">임시</span> <span class="n">파일에</span> <span class="n">저장</span> <span class="n">완료</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmp_xxx</span><span class="o">/</span><span class="n">output</span><span class="o">.</span><span class="n">parquet</span>
<span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">원자적</span> <span class="n">교체</span> <span class="n">완료</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmp_xxx</span><span class="o">/</span><span class="n">output</span><span class="o">.</span><span class="n">parquet</span> <span class="o">-&gt;</span> <span class="n">output</span><span class="o">.</span><span class="n">parquet</span>
<span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">_SUCCESS</span> <span class="n">플래그</span> <span class="n">파일</span> <span class="n">생성</span><span class="p">:</span> <span class="n">output</span><span class="o">.</span><span class="n">parquet</span><span class="o">.</span><span class="n">_SUCCESS</span>
<span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">Atomic</span> <span class="n">write</span> <span class="n">completed</span> <span class="n">successfully</span> <span class="p">(</span><span class="n">took</span> <span class="mf">0.2359</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="verbose-true">
<h3>상세 진단 모드 (verbose=True):<a class="headerlink" href="#verbose-true" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 상세한 성능 진단 정보 출력</span>
<span class="n">aw</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;output.parquet&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;parquet&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>출력 예시:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">임시</span> <span class="n">디렉토리</span> <span class="n">생성</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmp_xxx</span>
<span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">임시</span> <span class="n">파일</span> <span class="n">경로</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmp_xxx</span><span class="o">/</span><span class="n">output</span><span class="o">.</span><span class="n">parquet</span>
<span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">사용할</span> <span class="n">writer</span><span class="p">:</span> <span class="n">to_parquet</span> <span class="p">(</span><span class="nb">format</span><span class="p">:</span> <span class="n">parquet</span><span class="p">)</span>
<span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">데이터</span> <span class="n">임시</span> <span class="n">파일에</span> <span class="n">저장</span> <span class="n">완료</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmp_xxx</span><span class="o">/</span><span class="n">output</span><span class="o">.</span><span class="n">parquet</span>
<span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">원자적</span> <span class="n">교체</span> <span class="n">완료</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmp_xxx</span><span class="o">/</span><span class="n">output</span><span class="o">.</span><span class="n">parquet</span> <span class="o">-&gt;</span> <span class="n">output</span><span class="o">.</span><span class="n">parquet</span>
<span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">_SUCCESS</span> <span class="n">플래그</span> <span class="n">파일</span> <span class="n">생성</span><span class="p">:</span> <span class="n">output</span><span class="o">.</span><span class="n">parquet</span><span class="o">.</span><span class="n">_SUCCESS</span>
<span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">Atomic</span> <span class="n">write</span> <span class="n">step</span> <span class="n">timings</span> <span class="p">(</span><span class="n">SUCCESS</span><span class="p">):</span> <span class="n">setup</span><span class="o">=</span><span class="mf">0.0012</span><span class="n">s</span><span class="p">,</span> <span class="n">write_call</span><span class="o">=</span><span class="mf">0.2345</span><span class="n">s</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="mf">0.0001</span><span class="n">s</span><span class="p">,</span> <span class="n">success_flag</span><span class="o">=</span><span class="mf">0.0001</span><span class="n">s</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="mf">0.2359</span><span class="n">s</span>
</pre></div>
</div>
</section>
<section id="id3">
<h3>오류 발생 시 (기본 사용법):<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">임시</span> <span class="n">디렉토리</span> <span class="n">생성</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmp_xxx</span>
<span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">임시</span> <span class="n">파일</span> <span class="n">경로</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmp_xxx</span><span class="o">/</span><span class="n">output</span><span class="o">.</span><span class="n">parquet</span>
<span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">사용할</span> <span class="n">writer</span><span class="p">:</span> <span class="n">to_parquet</span> <span class="p">(</span><span class="nb">format</span><span class="p">:</span> <span class="n">parquet</span><span class="p">)</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span> <span class="n">임시</span> <span class="n">파일</span> <span class="n">저장</span> <span class="n">중</span> <span class="n">예외</span> <span class="n">발생</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">28</span><span class="p">]</span> <span class="n">No</span> <span class="n">space</span> <span class="n">left</span> <span class="n">on</span> <span class="n">device</span>
<span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">Atomic</span> <span class="n">write</span> <span class="n">failed</span> <span class="n">during</span> <span class="n">write</span> <span class="n">stage</span> <span class="p">(</span><span class="n">took</span> <span class="mf">0.1246</span><span class="n">s</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="ne">OSError</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id4">
<h3>오류 발생 시 (verbose=True):<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">임시</span> <span class="n">디렉토리</span> <span class="n">생성</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmp_xxx</span>
<span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">임시</span> <span class="n">파일</span> <span class="n">경로</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmp_xxx</span><span class="o">/</span><span class="n">output</span><span class="o">.</span><span class="n">parquet</span>
<span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">사용할</span> <span class="n">writer</span><span class="p">:</span> <span class="n">to_parquet</span> <span class="p">(</span><span class="nb">format</span><span class="p">:</span> <span class="n">parquet</span><span class="p">)</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span> <span class="n">임시</span> <span class="n">파일</span> <span class="n">저장</span> <span class="n">중</span> <span class="n">예외</span> <span class="n">발생</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">28</span><span class="p">]</span> <span class="n">No</span> <span class="n">space</span> <span class="n">left</span> <span class="n">on</span> <span class="n">device</span>
<span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">Atomic</span> <span class="n">write</span> <span class="n">step</span> <span class="n">timings</span> <span class="p">(</span><span class="n">ERROR</span> <span class="n">during</span> <span class="n">write</span><span class="p">):</span> <span class="n">setup</span><span class="o">=</span><span class="mf">0.0012</span><span class="n">s</span><span class="p">,</span> <span class="n">write_call</span><span class="o">=</span><span class="mf">0.1234</span><span class="n">s</span> <span class="p">(</span><span class="n">실패</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="n">N</span><span class="o">/</span><span class="n">A</span><span class="p">,</span> <span class="n">success_flag</span><span class="o">=</span><span class="n">N</span><span class="o">/</span><span class="n">A</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="mf">0.1246</span><span class="n">s</span><span class="p">,</span> <span class="n">error_type</span><span class="o">=</span><span class="ne">OSError</span>
</pre></div>
</div>
<p><strong>측정되는 단계:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">setup</span></code>: 임시 폴더 생성 및 초기 설정</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">write_call</span></code>: 실제 데이터 쓰기 함수 호출 (대부분의 시간 소요)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">replace</span></code>: 원자적 파일 교체</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">success_flag</span></code>: _SUCCESS 플래그 파일 생성</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total</span></code>: 전체 작업 시간</p></li>
</ul>
<p><strong>지원하는 오류 상황:</strong></p>
<ul class="simple">
<li><p>✅ <strong>KeyboardInterrupt</strong>: 인터럽트 발생 시점과 소요 시간 표시</p></li>
<li><p>✅ <strong>권한 오류</strong>: 파일 시스템 권한 문제 진단</p></li>
<li><p>✅ <strong>디스크 공간 부족</strong>: 저장 공간 부족 상황 진단</p></li>
<li><p>✅ <strong>메모리 부족</strong>: 메모리 압박 상황 진단</p></li>
<li><p>✅ <strong>네트워크 오류</strong>: 네트워크 드라이브 접근 문제 진단</p></li>
<li><p>✅ <strong>지원하지 않는 형식</strong>: 잘못된 파일 형식 지정 시 진단</p></li>
<li><p>✅ <strong>동시 접근 오류</strong>: 멀티스레딩 환경에서의 충돌 진단</p></li>
</ul>
<p><strong>장점:</strong></p>
<ul class="simple">
<li><p>🎯 <strong>정확한 병목점 파악</strong>: Atio 오버헤드 vs 실제 쓰기 작업 시간 구분</p></li>
<li><p>🔧 <strong>성능 최적화 가이드</strong>: 어느 단계에서 시간이 많이 소요되는지 명확히 표시</p></li>
<li><p>🐛 <strong>디버깅 시간 단축</strong>: 문제의 원인을 빠르게 파악 가능</p></li>
<li><p>📊 <strong>성능 모니터링</strong>: 대용량 데이터 처리 시 성능 추적</p></li>
<li><p>🚨 <strong>오류 진단</strong>: 실패 상황에서도 정확한 원인과 발생 시점 파악</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="id5">
<h2>🧠 왜 이 도구가 정말 중요한가요?<a class="headerlink" href="#id5" title="Link to this heading"></a></h2>
<p>NumPy나 Pandas는 데이터 분석에서는 최적이지만, <strong>파일로 저장할 때는 아래와 같은 위험</strong>이 있습니다:</p>
<ol class="arabic simple">
<li><p><strong>파일 일부만 저장되어 깨질 수 있음</strong> — 강제 종료나 오류 시</p></li>
<li><p><strong>동시 쓰기 충돌</strong> — 멀티프로세스 환경에서 파일이 엉킬 수 있음</p></li>
<li><p><strong>플랫폼 간 동작 차이</strong> — Windows와 Linux/macOS에서 파일 시스템 동작이 다름</p></li>
</ol>
<p>AtomicWriter는 임시 파일에 쓰고 <strong>단일 <code class="docutils literal notranslate"><span class="pre">rename()</span></code>/<code class="docutils literal notranslate"><span class="pre">replace()</span></code> 작업으로 교체</strong>합니다.<br />
이 방식은 <strong>“완전히 저장되거나 전혀 저장되지 않는”</strong> 원자성(atomicity)을 보장하며,</p>
<ul class="simple">
<li><p>POSIX: <code class="docutils literal notranslate"><span class="pre">os.replace</span></code> (atomic), <code class="docutils literal notranslate"><span class="pre">fsync</span></code></p></li>
<li><p>Windows: <code class="docutils literal notranslate"><span class="pre">MoveFileEx</span></code>, <code class="docutils literal notranslate"><span class="pre">Commit</span></code><br />
를 활용하여 파일이 <strong>항상 일관된 상태</strong>를 유지하도록 합니다 :contentReference[oaicite:1]{index=1}.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="id6">
<h2>⚙️ 설치<a class="headerlink" href="#id6" title="Link to this heading"></a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>atomicwriter

<span class="c1">## 🛠️ 사용 예제</span>

<span class="sb">```</span>python
import<span class="w"> </span>atomicwriter<span class="w"> </span>as<span class="w"> </span>aw
import<span class="w"> </span>pandas<span class="w"> </span>as<span class="w"> </span>pd

<span class="nv">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pd.DataFrame<span class="o">({</span><span class="s2">&quot;a&quot;</span>:<span class="w"> </span><span class="o">[</span><span class="m">1</span>,<span class="w"> </span><span class="m">2</span>,<span class="w"> </span><span class="m">3</span><span class="o">]})</span>

<span class="c1"># 기본 사용법</span>
aw.write<span class="o">(</span>df,<span class="w"> </span><span class="s2">&quot;output.parquet&quot;</span>,<span class="w"> </span><span class="nv">format</span><span class="o">=</span><span class="s2">&quot;parquet&quot;</span><span class="o">)</span>
<span class="c1"># │→ 임시 파일 작성 → 원자적 교체 → _SUCCESS 생성</span>
<span class="c1"># │→ 실패 시 원본 보존, 임시 파일 자동 정리</span>

<span class="c1"># 상세 성능 진단 로깅 활성화</span>
aw.write<span class="o">(</span>df,<span class="w"> </span><span class="s2">&quot;output_verbose.parquet&quot;</span>,<span class="w"> </span><span class="nv">format</span><span class="o">=</span><span class="s2">&quot;parquet&quot;</span>,<span class="w"> </span><span class="nv">verbose</span><span class="o">=</span>True<span class="o">)</span>
<span class="c1"># │→ 각 단계별 실행 시간 측정 및 로그 출력</span>

<span class="c1"># 진행도 표시와 함께 사용</span>
aw.write<span class="o">(</span>df,<span class="w"> </span><span class="s2">&quot;output_progress.parquet&quot;</span>,<span class="w"> </span><span class="nv">format</span><span class="o">=</span><span class="s2">&quot;parquet&quot;</span>,<span class="w"> </span><span class="nv">show_progress</span><span class="o">=</span>True<span class="o">)</span>
<span class="c1"># │→ 실시간 진행도 표시</span>

<span class="c1"># 모든 옵션 조합</span>
aw.write<span class="o">(</span>df,<span class="w"> </span><span class="s2">&quot;output_full.parquet&quot;</span>,<span class="w"> </span><span class="nv">format</span><span class="o">=</span><span class="s2">&quot;parquet&quot;</span>,<span class="w"> </span>
<span class="w">         </span><span class="nv">verbose</span><span class="o">=</span>True,<span class="w"> </span><span class="nv">show_progress</span><span class="o">=</span>True<span class="o">)</span>
<span class="c1"># │→ 성능 진단 + 진행도 표시</span>
</pre></div>
</div>
</section>
<section id="id7">
<h2>💡 빅데이터 워크플로우에서 활용 시나리오<a class="headerlink" href="#id7" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>시나리오</p></th>
<th class="head"><p>해결 방법</p></th>
<th class="head"><p>장점</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Pandas → CSV 저장</p></td>
<td><p>임시 파일에 기록 후 교체</p></td>
<td><p>CSV 파일 깨짐 방지</p></td>
</tr>
<tr class="row-odd"><td><p>멀티프로세스 병렬 쓰기</p></td>
<td><p>atomic replace 방식 사용</p></td>
<td><p>충돌 없는 안전 저장</p></td>
</tr>
<tr class="row-even"><td><p>데이터 파이프라인 작업</p></td>
<td><p>저장 성공 시 <code class="docutils literal notranslate"><span class="pre">_SUCCESS</span></code> 확인</p></td>
<td><p>데이터 완전성 보장</p></td>
</tr>
</tbody>
</table>
</section>
<hr class="docutils" />
<section id="id8">
<h2>🔄 비교 – 유사 라이브러리 특징 정리<a class="headerlink" href="#id8" title="Link to this heading"></a></h2>
<section id="python-atomicwrites">
<h3><a class="reference external" href="https://github.com/untitaker/python-atomicwrites">python-atomicwrites</a><a class="headerlink" href="#python-atomicwrites" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>간편한 API</p></li>
<li><p>Windows 지원</p></li>
<li><p>크로스 플랫폼 호환</p></li>
</ul>
</section>
<section id="atomicwriter">
<h3>atomicwriter (본 프로젝트)<a class="headerlink" href="#atomicwriter" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>✅ 경량</p></li>
<li><p>✅ 플러그인 아키텍처</p></li>
<li><p>✅ Pandas / Polars / Numpy 등 데이터 객체 중심 저장 지원</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="id9">
<h2>✅ 라이선스<a class="headerlink" href="#id9" title="Link to this heading"></a></h2>
<p>Apache 2.0 — 기업 및 커뮤니티 모두 자유롭게 사용 가능</p>
</section>
<hr class="docutils" />
<section id="id10">
<h2>✨ 요약<a class="headerlink" href="#id10" title="Link to this heading"></a></h2>
<p><strong>AtomicWriter</strong>는 분석만큼 중요한 <strong>“저장” 단계를 안전하게 처리</strong>하는 도구입니다.</p>
<p>특히 데이터 무결성이 중요한 환경에서<br />
(예: 머신러닝 배치, 멀티프로세스 분석, 중요 로그 저장 등)<br />
<strong>작지만 강력한 해결책</strong>을 제공합니다.</p>
<p>📘 시나리오 1: Pandas CSV 저장 중 작업 중단
문제 상황:
한 사용자가 Pandas로 대용량 분석 결과를 .csv 파일로 저장하던 중, 예상치 못한 전원 차단이나 커널 강제 종료가 발생했습니다.
결과 파일은 50MB 중 3MB만 저장된 채 손상되었고, 이후 읽기도 되지 않았습니다.</p>
<p>AtomicWriter로 해결:
임시 파일에 먼저 기록 후, 모든 쓰기가 성공해야만 원본과 교체됩니다.
따라서 중간에 꺼져도 기존 파일은 보존되고, 손상된 임시 파일은 자동 정리되어 안정성을 확보할 수 있습니다.</p>
<p>📘 시나리오 2: 멀티프로세스 환경에서 경쟁 조건(Race Condition)
문제 상황:
Python multiprocessing 기반 데이터 수집 파이프라인에서 여러 프로세스가 동시에 같은 파일을 저장하며 충돌이 발생했습니다.
결과적으로 로그 파일이 덮어쓰여 누락되거나, 일부 JSON 파일은 파싱할 수 없는 손상된 형태로 저장됐습니다.</p>
<p>AtomicWriter로 해결:
파일 쓰기를 atomic replace 방식으로 수행하면, 한 번에 하나의 프로세스만 최종 경로로 이동할 수 있습니다.
이로써 경쟁 조건 없이 충돌 없이 저장이 보장됩니다.</p>
<p>📘 시나리오 3: 데이터 파이프라인 검증 불가
문제 상황:
ETL 작업에서 .parquet 저장이 완료됐는지 여부를 자동 시스템이 판단할 수 없어, 손상되거나 미완성된 데이터를 다음 단계에서 그대로 사용했습니다.
결과적으로 모델 학습 데이터에 결측값이 포함되어 품질 저하가 발생했습니다.</p>
<p>AtomicWriter로 해결:
저장이 성공적으로 완료된 경우에만 _SUCCESS 플래그 파일을 함께 생성하도록 설정할 수 있습니다.
후속 단계는 _SUCCESS 유무를 기준으로 안전하게 파이프라인을 구동할 수 있습니다.</p>
<p>📘 시나리오 4: Polars DataFrame을 S3로 저장 중 오류 발생
문제 상황:
Polars DataFrame을 AWS S3에 직접 저장하는 중간에 ConnectionError가 발생하여 S3에는 부분적으로 깨진 .parquet 파일이 올라갔습니다.
다음 번 실행에서 이 파일을 재사용하려 했지만, S3에서 파일이 손상된 채로 존재해 오류를 유발했습니다.</p>
<p>AtomicWriter로 해결:
로컬 임시 파일에 완전히 저장된 후에만 S3 업로드 또는 교체가 수행됩니다.
네트워크 이슈나 디스크 오류에도 최종 파일은 항상 완전한 상태로만 존재하게 됩니다.</p>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/_autosummary/atio.html">atio</a></li>
</ul>
</li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="api/modules.html" class="btn btn-neutral float-right" title="Modules" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, jujangchoi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>